{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3ER,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,M,+BCLvD,MAAM,EAA+BC,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,uC,aCIxDC,IAAAA,aAAAA,IAAqB,6CAA6C,YAChEC,EAAAA,EAAAA,QAAOC,IAAAA,UAA8B,YAAY,WAC/C,IAAMC,EAAkBH,IAAAA,MAAAA,UAAoB,4DAA8D,EACpGI,EAAWC,SAASC,cAAc,wBAClCC,EAAaF,SAASC,cAAc,wCACtCE,EAAU,KAwDdD,EAAWE,iBAAiB,SAAS,SAACC,GAtDtC,IACQC,EAsDNC,aAAaJ,GACbA,EAAUK,YAAW,WAnDvB,IAAqCC,EAC7BC,EACAC,EAF6BF,EAoDLJ,EAAEO,OAAOrB,MAnDjCmB,EAAaf,IAAAA,WAAAA,MAAqB,yDAClCgB,EAAOhB,IAAAA,WAAAA,MAAqB,mEAEpBA,IAAAA,MAAAA,KACN,cAAe,CACnBkB,KAAM,CAACC,MAAOhB,GACd,YAAaW,IAEdM,MAAK,SAACC,GACL,GAAyB,KAArBd,EAAWX,OACXyB,EAAIC,OAAS,EAAG,CAClB,IAAMC,EAAYlB,SAASmB,cAAc,OACzCD,EAAUE,aAAa,QAAS,qBAChCF,EAAUE,aAAa,KAAM,iBAC7BF,EAAUG,UAAV,gFAEoCX,EAFpC,4DAGwCC,EAHxC,mDAOAK,EAAIM,SAAQ,SAACC,GACX,IAAMC,EAAMxB,SAASmB,cAAc,OACnCK,EAAIJ,aAAa,KAAM,uBACvBI,EAAIJ,aAAa,QAAS,uBAC1B,IAAIK,EAAYF,EAAIG,KAAKC,WAAWC,cAGlCH,GADgB,IAAdA,EACU,iDAAiD9B,IAAAA,WAAAA,MAAqB,iEAEtE,GAGd6B,EAAIH,UAAJ,yLAIoC1B,IAAAA,MAAAA,WAAqB4B,GAJzD,IAIiEA,EAAIG,KAAKC,WAAWlB,MAJrF,oFAK+DgB,EAL/D,gEAQAP,EAAUW,YAAYL,GACtBzB,EAAS+B,sBAAsB,cAAeZ,YAUnD,MAzDGZ,EAAaN,SAAS+B,eAAe,mBAC9BzB,EAAW0B,mB","sources":["webpack://@justoverclock/check-duplicate-discussions/webpack/bootstrap","webpack://@justoverclock/check-duplicate-discussions/webpack/runtime/compat get default export","webpack://@justoverclock/check-duplicate-discussions/webpack/runtime/define property getters","webpack://@justoverclock/check-duplicate-discussions/webpack/runtime/hasOwnProperty shorthand","webpack://@justoverclock/check-duplicate-discussions/webpack/runtime/make namespace object","webpack://@justoverclock/check-duplicate-discussions/external root \"flarum.core.compat['forum/app']\"","webpack://@justoverclock/check-duplicate-discussions/external root \"flarum.core.compat['common/extend']\"","webpack://@justoverclock/check-duplicate-discussions/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@justoverclock/check-duplicate-discussions/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\n\napp.initializers.add('justoverclock/check-duplicate-discussions', () => {\n  extend(DiscussionComposer.prototype, 'oncreate', function () {\n    const numberOfSimilar = app.forum.attribute('justoverclock-check-duplicate-discussions.similarNumber') || 3;\n    const composer = document.querySelector('.ComposerBody-editor');\n    const inputTitle = document.querySelector('li.item-discussionTitle > h3 > input');\n    let timeout = null;\n\n    function clearSimilarDiscussions() {\n      const resultDisc = document.getElementById('sim-container');\n      resultDisc ? resultDisc.remove() : false;\n    }\n\n    function searchForSimilarDiscussions(title) {\n      const checkTitle = app.translator.trans('justoverclock-check-duplicate-discussions.forum.title');\n      const desc = app.translator.trans('justoverclock-check-duplicate-discussions.forum.foundDiscussion');\n\n      let simDisc = app.store\n        .find('discussions', {\n          page: {limit: numberOfSimilar},\n          'filter[q]': title,\n        })\n        .then((res) => {\n          if (inputTitle.value === '') return;\n          if (res.length > 0) {\n            const container = document.createElement('div');\n            container.setAttribute('class', 'simdisc-container');\n            container.setAttribute('id', 'sim-container');\n            container.innerHTML = `\n                      <div>\n                         <p class=\"simtitle\" >${checkTitle} </p>\n                         <p class=\"simtitle-desc\">${desc}</p>\n                      </div>\n            `;\n\n            res.forEach((sim) => {\n              const div = document.createElement('div');\n              div.setAttribute('id', 'similar-discussions');\n              div.setAttribute('class', 'similar-discussions');\n              let baSimilar = sim.data.attributes.hasBestAnswer\n\n              if (baSimilar !== false){\n                baSimilar = `<i class=\"fas fa-check-circle simsolved\"></i> ${app.translator.trans('justoverclock-check-duplicate-discussions.forum.solvedSimilar')}`\n              } else {\n                baSimilar = ''\n              }\n\n              div.innerHTML = `\n                  <div class=\"simdisc\">\n                     <li>\n                        <i class=\"fas fa-exclamation sim\"></i>\n                        <a class=\"simlink\" href=${app.route.discussion(sim)}>${sim.data.attributes.title}</a>\n                        <span class=\"bestAnswer-similar\" id=\"best-similar\">${baSimilar}</span>\n                     </li>\n                  </div>`;\n              container.appendChild(div);\n              composer.insertAdjacentElement('beforebegin', container);\n            });\n          }\n        });\n    }\n\n    inputTitle.addEventListener('keyup', (e) => {\n      clearTimeout(timeout);\n      timeout = setTimeout(function () {\n        searchForSimilarDiscussions(e.target.value);\n      }, 1000);\n      clearSimilarDiscussions();\n    });\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","app","extend","DiscussionComposer","numberOfSimilar","composer","document","querySelector","inputTitle","timeout","addEventListener","e","resultDisc","clearTimeout","setTimeout","title","checkTitle","desc","target","page","limit","then","res","length","container","createElement","setAttribute","innerHTML","forEach","sim","div","baSimilar","data","attributes","hasBestAnswer","appendChild","insertAdjacentElement","getElementById","remove"],"sourceRoot":""}